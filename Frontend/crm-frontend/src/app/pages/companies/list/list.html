<div class="page-container">

  <mat-card class="company-card">
    <mat-card-header>
      <div mat-card-avatar>
        <mat-icon>business</mat-icon>
      </div>
      <mat-card-title class="page-title">Companies</mat-card-title>
      <mat-card-subtitle class="page-subtitle">Manage your partners</mat-card-subtitle>
      <span class="spacer"></span>
      <button mat-flat-button color="primary" (click)="newCompany()">
        <mat-icon>add</mat-icon> Add
      </button>
    </mat-card-header>
  </mat-card>

  <mat-card class="table-card">
    <div class="custom-table">
      <div class="table-row header-row">
        <span class="col-name">Name</span>
        <span class="col-industry">Industry</span>
        <span class="col-contact">Contact Info</span>
        <span class="col-date">Created</span>
        <span class="col-actions"></span>
      </div>

      @for (company of companies; track company.id) {
        <div class="table-row data-row" (click)="goToCompany(company.id)">
          
          <div class="col-name cell-with-avatar">
            <div class="company-avatar">
              {{ company.name.charAt(0).toLocaleUpperCase() }}
            </div>
            <div class="name-info">
              <span class="primary-text">{{ company.name }}</span>
              <span class="secondary-text">NIP: {{ company.nip }}</span>
            </div>
          </div>

          <div class="col-industry">
            <span class="industry-badge">{{ company.industry }}</span>
          </div>

          <div class="col-contact">
            <div class="contact-details">
              @if(company.website) {
                <a [href]="company.website" target="_blank" (click)="$event.stopPropagation()" class="icon-link">
                  <mat-icon>language</mat-icon> {{ company.website }}
                </a>
              }
              <span class="icon-text">
                <mat-icon>phone</mat-icon> {{ company.phoneNumber }}
              </span>
            </div>
          </div>

          <div class="col-date secondary-text">
            {{ company.createdAt | date: 'dd MMM yyyy' }}
          </div>

          <div class="col-actions">
            <button mat-icon-button [matMenuTriggerFor]="menu" (click)="$event.stopPropagation()">
              <mat-icon>more_vert</mat-icon>
            </button>
            <mat-menu #menu="matMenu">
              <button mat-menu-item (click)="editCompany(company.id)">
                <mat-icon>edit</mat-icon>
                <span>Edit</span>
              </button>
              <button mat-menu-item class="delete-action">
                <mat-icon color="warn">delete</mat-icon>
                <span>Delete</span>
              </button>
            </mat-menu>
          </div>
        </div>
      } @empty {
        <div class="empty-state">
          <mat-icon>business_off</mat-icon>
          <p>No companies found. Add your first client to get started.</p>
        </div>
      }
    </div>
  </mat-card>
</div>